/* version 0.2 du                                                         */
/*  dernire modification :                                               */
/*         16 09 2013 (SD)                                                */
/*  auteur :                                                              */
/*         SD Samuel Dom (sdeom@epadesa.fr)                              */

/* Pour fonctionner il faut inclure pralablement la boite  outils       */
/*  epListeOutils                                                         */

/* Liste des routines (en ordre alphabtique)                             */
/*  QAOlstCMP(nom_liste) Rempli les textes d'un controles de menu        */
/*         droulant  partir d'un composant liste                        */
/*         dernire modification : 16 09 2013 (SD)                        */
/*  QMODlstET(nom_ctrl,nom_liste,nom_prc) Instancie la proprit ET    */
/*         d'un contrle en fonction du rang d'une valeur  chercher dans */
/*         une liste                                                      */
/*         dernire modification : 27 11 2012 (SD)                        */


rout,QAOlstCMP(nom_liste)
/* Permet de remplir les textes de contrle de type CB, OP etc.  partir  */
/*  d'un composant liste (epL) dont le nom est pass dans la procdure    */
/*  nom_liste. La routine ajoute dans le contrle chacune des tiquettes */
/*  (contenues dans les rallonges Q)                                      */
{
  var,liste
  
  run,SELcmpLST([nom_liste],liste) /* selection du bon composant liste et stockage dans la procdure liste */
  if,"liste><`vide`"
  {
  runr,comp=[liste],type=V
    {
      qao,et=[ii],tx=[[mm]&Q[ii]:]
    }
  }
}


rout,QMODlstET(nom_ctrl,nom_liste,nom_prc)
/* Permet d'instancier la proprit ET d'un controle dont l'identifiant   */
/*  est nom_ctrl                                                         */
/*  avec le rang de la dernire ligne dont la valeur (rallonge V) est     */
/*  gale  la valeur de la procdure dont le nom est pass dans nom_prc */
/*  de la liste dont le nom est pass dans la variable nom_liste         */
/*  si la valeur n'apparait pas, ET est instanci  0                     */
{
  var,et,liste
  et=0
  
  run,SELcmpLST([nom_liste],liste) /* selection du bon composant liste et stockage dans le composant liste */
  
  if,"liste><`vide`"
  {
    runr,comp=[liste],type=V
    {
      if,"[mm]&V[ii]:==[nom_prc]"
      {
        et=[ii]
        [fi]
      }
    }
  }
  QMOD,ID=[nom_ctrl],ET=[et]
}